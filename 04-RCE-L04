
문제
이 프로그램은 디버거 프로그램을 탐지하는 기능을 갖고 있다. 디버거를 탐지하는 함수의 이름은 무엇인가

#문제풀이
디버거 프로그램을 탐지하는 기능을 갖고 있다고 한다. 일단 파일을 실행을 하면은 1초마다 정상이라는 단어가 계속뜬다.
디버거의 뜻이란?
다른 대상 프로그램을 테스트하고 디버그하는 데 쓰이는 컴퓨터 프로그램 (위키피디아)

올리디버거의 같은 그런의미인건가?
한번 돌려본다. 오신기하다 디버거로 실행을하니 '디버거당함' 이라는 단어가 나온다.
그럼 디버거를 돌리면서 안당하게 하는방법을 찾는것인가?

음 디버거 오른쪽마우스-serach for-string (문자열 찾기) 를 해도 정상이나 디버깅당함이라는 뜻이 안나온다. 디버깅탐지하는 함수가 있을까?

검색해서 보니 IsDebuggerPresent 함수가 디버거를 감지하는 함수이다.
올리디버거 에서 serach for-call 을 하면은 프로그램내의 함수를 알수있다. 검색해보니 탐지함수가 있다.
근데 여기서 어떻게 조작을 해야 하는지를 모르겠다. 
위의 Kernel32.Sleep 함수는 시간끊기 함수인가 검색해보자. 

주소값 00401033에 브레이크포인트를 걸고 F9까지 실행을 하고 
이후에 F8로 천천히 진행을 하면서 파악
중요한 키포인트는 EAX, TEST, ZF, JZ함수이다 .CALL 00408190은 아마 출력하는 함수이고 
EAX 값은 처음에 0이었다가 IsDebuggerPresent 함수를 지나고 나면 EAX가 1로 설정이 됀다.
지금 디버거로 진행중이니 아마 디버거중에 이함수를 지나면 EAX가 1로 설정돼는듯하다.
후에 TEST EAX, EAX 값을 하여 지금 EAX값이 1이므로 AND연산을 하면은 결과가 1이다.
TEST의 결과는 ZF에 저장이 돼는데 값이 1이면 ZF는 0, 값이 0이면 ZF는 1로 설정
지금 결과는 ZF가 0으로 저장 -> 후에 JZ: ZF가 1이면 이동인데 값이 0이므로 그냥 다음칸으로 이동
하여 "디버깅당함"을 출력하고 다시 무한반복으로 끝난다.

이를 정상으로 탐지하기 위해 디버깅함수를 지나고 EAX값을 0으로 설정을 하고 진행을 하
"정상"이 출력이 됀다.

어셈블리어 추가는 없나?
